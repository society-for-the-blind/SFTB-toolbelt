<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Read the contents of a file with docx extension and generate JSZip commands by parsing files (and folders) to BASE64 data URIs" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.3/FileSaver.min.js" integrity="sha256-FPJJt8nA+xL4RU6/gsriA8p8xAeLGatoyTjldvQKGdE=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js" integrity="sha256-RbP/rbx4XeYJH6eYUniR63Jk5NEV48Gjestg49cNSWY=" crossorigin="anonymous"></script>
    <title>docx to JSZip commands</title>
  <head>
  <body>
    <div>
      <p>Read the contents of a file with docx extension and generate JSZip commands by parsing files (and folders) to BASE64 data URIs</p>
      <p>(and a generate a form for templating but that part is still fuzzy)</p>
      <p>Most of this page is from https://stuk.github.io/jszip/documentation/examples/download-zip-file.html</p>
    </div>
    <div>
      <input type="file" name="file" id="file" multiple/>
    </div>
  </body>
</html>
<!-- var z = {}; -->
<!-- var txt = ""; -->
<!-- var prs = []; -->

<!-- dx = document.getElementsByTagName("input")[0].files[0]; -->
<!-- p = JSZip.loadAsync(dx). -->
<!--       then -->
<!--       ( -->
<!--         function(zip) -->
<!--         { -->
<!--           //z = zip; -->
<!--           txt = Object.getOwnPropertyNames(zip.files); -->
<!--           for (let i=0; i<txt.length; i++) -->
<!--           { -->
<!--             fname = txt[i]; -->
<!--             if ( !(fname[fname.length-1] === "/") ) -->
<!--             { -->
<!--               prs.push(zip. -->
<!--                 file(fname). -->
<!--                 async("base64")) -->
<!--              } -->
<!--           } -->
<!--           return Promise.all(prs) -->
<!--         }, --> 
<!--         function(e) -->
<!--         { -->
<!--           console.log("Error reading " + f.name + " : " + e.message) -->
<!--         } -->
<!--       ). -->
<!--       then -->
<!--       ( -->
<!--         function(vals) -->
<!--         { -->
<!--           var zn = new JSZip(); -->
<!--           for (let i in vals) -->
<!--           { -->
<!--             zn.file(txt[i], vals[i], {base64: true}) -->
<!--           } -->
<!--           return zn; -->
<!--         } -->
<!--       ).then -->
<!--       ( -->
<!--         function (blob) -->
<!--         { -->
<!--           // data (i.e., blob) to ELM port will be sent from here I guess -->
<!--         } -->
<!--       ) -->
<!-- /* -->
<!-- then -->
<!-- ( -->
<!--   function(vals) -->
<!--   { -->
<!--     for (let i in vals) -->
<!--     { -->
<!--       zn.file(txt[i], vals[i], {base64: true}) -->
<!--     } -->
<!--     return zn.generateAsync({type:"blob"}) -->
<!--   } -->
<!-- ).then(function (blob) { -->
<!--   saveAs(blob, "lofa.docx"); -->
<!-- }, function (err) { -->
<!--     blobLink.innerHTML += " " + err; -->
<!-- }); -->
<!-- */ -->

<!-- var z = {}; -->
<!-- var txt = ""; -->
<!-- var prs = []; -->

<!-- dx = document.getElementsByTagName("input")[0].files[0]; -->
<!-- p = JSZip.loadAsync(dx). -->
<!--       then -->
<!--       ( -->
<!--         function(zip) -->
<!--         { -->
<!--           //z = zip; -->
<!--           txt = Object.getOwnPropertyNames(zip.files); -->
          
<!--           for (let i=0; i<txt.length; i++) -->
<!--           { -->
<!--             fname = txt[i]; -->
<!--             if ( !(fname[fname.length-1] === "/") ) -->
<!--             { -->
<!--               prs.push(zip. -->
<!--                 file(fname). -->
<!--                 async("base64")) -->
<!--              } -->
<!--           } -->
<!--           return Promise.all(prs) -->
<!--         }, --> 
<!--         function(e) -->
<!--         { -->
<!--           console.log("Error reading " + f.name + " : " + e.message) -->
<!--         } -->
<!--       ). -->
<!--       then -->
<!--       ( -->
<!--         function(f64s) -->
<!--         { -->
<!--           var jszipCmd = 'var zip = new JSZip()'; -->
<!--           for (let i in f64s) -->
<!--           { -->
<!--             jszipCmd += '.file("' + txt[i] + '","' + f64s[i] + '",{base64: true})' -->
<!--           //zn.file(txt[i], vals[i], {base64: true}) -->
<!--           } -->
<!--           return jszipCmd; -->
<!--         } -->
<!--       ). -->
<!--       then -->
<!--       ( -->
<!--         function(cmd) -->
<!--         { -->
<!--           var a = document.createElement('A'); -->
<!--           document.getElementsByTagName('div')[0].appendChild(a); -->
<!--           a.textContent = 'result'; -->
<!--           b64 = btoa('<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.3/FileSaver.min.js" integrity="sha256-FPJJt8nA+xL4RU6/gsriA8p8xAeLGatoyTjldvQKGdE=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js" integrity="sha256-RbP/rbx4XeYJH6eYUniR63Jk5NEV48Gjestg49cNSWY=" crossorigin="anonymous"></script>' + "<script>" + cmd + "</script>"); -->
<!--           a.href = 'data:text/html;base64,' + b64; -->
<!--         } -->
<!--       ) -->
